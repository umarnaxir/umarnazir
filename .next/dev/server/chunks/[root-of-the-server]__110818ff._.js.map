{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/umarnazir/Documents/websites/umarnazir/app/api/contact/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { Resend } from \"resend\";\n\nconst TEAM_EMAIL = \"sd.umarnazir@gmail.com\";\nconst FROM_EMAIL = \"No Reply <no-reply@ninemash.com>\";\n\ntype TContactFormData = {\n  name: string;\n  email: string;\n  message: string;\n};\n\nfunction getContactFormHtmlForTeam(data: TContactFormData) {\n  return `\n    <h2>New Contact Form Submission</h2>\n    <p><strong>Name:</strong> ${data.name}</p>\n    <p><strong>Email:</strong> ${data.email}</p>\n    <p><strong>Message:</strong></p>\n    <p>${data.message.replace(/\\n/g, \"<br>\")}</p>\n  `;\n}\n\nexport async function POST(req: Request) {\n  try {\n    // Check if RESEND_API_KEY is configured\n    const resendApiKey = process.env.RESEND_API_KEY;\n    if (!resendApiKey) {\n      console.error(\"RESEND_API_KEY is not configured\");\n      return NextResponse.json(\n        { success: false, message: \"Email service is not configured. Please contact the administrator.\" },\n        { status: 500 }\n      );\n    }\n\n    const resend = new Resend(resendApiKey);\n    const data: TContactFormData = await req.json();\n\n    // Validate required fields\n    if (!data.name || !data.email || !data.message) {\n      return NextResponse.json(\n        { success: false, message: \"All fields are required\" },\n        { status: 400 }\n      );\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(data.email)) {\n      return NextResponse.json(\n        { success: false, message: \"Please provide a valid email address\" },\n        { status: 400 }\n      );\n    }\n\n    // Sanitize input to prevent XSS\n    const sanitizedData = {\n      name: data.name.trim().substring(0, 200),\n      email: data.email.trim().substring(0, 200),\n      message: data.message.trim().substring(0, 5000),\n    };\n\n    const result = await resend.emails.send({\n      from: FROM_EMAIL,\n      to: [TEAM_EMAIL],\n      subject: \"Contact Form Submission - Portfolio\",\n      html: getContactFormHtmlForTeam(sanitizedData),\n      replyTo: sanitizedData.email,\n    });\n\n    // Check if Resend returned an error\n    if (result.error) {\n      console.error(\"Resend API error:\", result.error);\n      return NextResponse.json(\n        { success: false, message: \"Failed to send message. Please try again later.\" },\n        { status: 500 }\n      );\n    }\n\n    return NextResponse.json(\n      { success: true, message: \"Message sent successfully!\" },\n      { status: 200 }\n    );\n  } catch (error) {\n    // Log the full error for debugging (server-side only)\n    console.error(\"Contact form error:\", error);\n    \n    // Don't expose internal error details to client\n    return NextResponse.json(\n      { success: false, message: \"Failed to send message. Please try again later.\" },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,aAAa;AACnB,MAAM,aAAa;AAQnB,SAAS,0BAA0B,IAAsB;IACvD,OAAO,CAAC;;8BAEoB,EAAE,KAAK,IAAI,CAAC;+BACX,EAAE,KAAK,KAAK,CAAC;;OAErC,EAAE,KAAK,OAAO,CAAC,OAAO,CAAC,OAAO,QAAQ;EAC3C,CAAC;AACH;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,wCAAwC;QACxC,MAAM,eAAe,QAAQ,GAAG,CAAC,cAAc;QAC/C,IAAI,CAAC,cAAc;YACjB,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAAqE,GAChG;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,IAAI,oJAAM,CAAC;QAC1B,MAAM,OAAyB,MAAM,IAAI,IAAI;QAE7C,2BAA2B;QAC3B,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,OAAO,EAAE;YAC9C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAA0B,GACrD;gBAAE,QAAQ;YAAI;QAElB;QAEA,wBAAwB;QACxB,MAAM,aAAa;QACnB,IAAI,CAAC,WAAW,IAAI,CAAC,KAAK,KAAK,GAAG;YAChC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAAuC,GAClE;gBAAE,QAAQ;YAAI;QAElB;QAEA,gCAAgC;QAChC,MAAM,gBAAgB;YACpB,MAAM,KAAK,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG;YACpC,OAAO,KAAK,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG;YACtC,SAAS,KAAK,OAAO,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG;QAC5C;QAEA,MAAM,SAAS,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;YACtC,MAAM;YACN,IAAI;gBAAC;aAAW;YAChB,SAAS;YACT,MAAM,0BAA0B;YAChC,SAAS,cAAc,KAAK;QAC9B;QAEA,oCAAoC;QACpC,IAAI,OAAO,KAAK,EAAE;YAChB,QAAQ,KAAK,CAAC,qBAAqB,OAAO,KAAK;YAC/C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAAkD,GAC7E;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAM,SAAS;QAA6B,GACvD;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,sDAAsD;QACtD,QAAQ,KAAK,CAAC,uBAAuB;QAErC,gDAAgD;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,SAAS;QAAkD,GAC7E;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}